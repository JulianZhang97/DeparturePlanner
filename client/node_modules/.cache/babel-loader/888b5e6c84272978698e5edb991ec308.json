{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\zhang\\\\OneDrive\\\\Documents\\\\Personal Projects\\\\departure-planner\\\\react-backend\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\zhang\\\\OneDrive\\\\Documents\\\\Personal Projects\\\\departure-planner\\\\react-backend\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\zhang\\\\OneDrive\\\\Documents\\\\Personal Projects\\\\departure-planner\\\\react-backend\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\zhang\\\\OneDrive\\\\Documents\\\\Personal Projects\\\\departure-planner\\\\react-backend\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\zhang\\\\OneDrive\\\\Documents\\\\Personal Projects\\\\departure-planner\\\\react-backend\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\zhang\\\\OneDrive\\\\Documents\\\\Personal Projects\\\\departure-planner\\\\react-backend\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"C:\\\\Users\\\\zhang\\\\OneDrive\\\\Documents\\\\Personal Projects\\\\departure-planner\\\\react-backend\\\\client\\\\src\\\\components\\\\ResultPage.js\";\nimport React, { Component } from 'react';\nimport ReactLoading from 'react-loading';\nimport Header from './Header.js';\nimport DirectionsMap from './DirectionsMap.js';\nimport axios from 'axios';\n\nvar ResultPage =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ResultPage, _Component);\n\n  function ResultPage(props) {\n    var _this;\n\n    _classCallCheck(this, ResultPage);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ResultPage).call(this, props));\n    _this.state = {\n      departureSite: _this.props.location.state.departureSite,\n      arrivalSite: _this.props.location.state.arrivalSite,\n      airline: _this.props.location.state.airline,\n      flightNum: _this.props.location.state.flightNum,\n      flightDate: _this.props.location.state.flightDate,\n      departureDetailsLoaded: false,\n      departureTime: \"\",\n      departureTimeZone: \"\",\n      flightExists: null,\n      curTime: new Date(),\n      mapsAPI: \"\",\n      curTravelTime: null,\n      testOrigin: \"Eaton Centre\",\n      testDest: \"YYZ\",\n      travelMode: \"DRIVING\",\n      drivingOptions: {\n        departureTime: new Date(),\n        trafficModel: 'bestguess'\n      }\n    };\n    _this.searchFlight = _this.searchFlight.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.getDepartureDetails = _this.getDepartureDetails.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(ResultPage, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      console.log(this.state);\n      var apiKey = process.env.REACT_APP_GOOGLE_API_KEY;\n      this.setState({\n        mapsAPI: apiKey\n      }); //  this.searchFlight();\n    }\n  }, {\n    key: \"searchFlight\",\n    value: function searchFlight() {\n      var flightSearchKey = process.env.REACT_APP_FLIGHT_API_KEY;\n      var proxyurl = \"https://cors-anywhere.herokuapp.com/\";\n      var init = {\n        headers: {\n          \"Ocp-Apim-Subscription-Key\": flightSearchKey\n        },\n        params: {\n          \"Airline\": this.state.airline,\n          \"FlightNumber\": this.state.flightNum\n        }\n      };\n      var self = this;\n      axios.get(proxyurl + \"https://flightlookup.azure-api.net/v1/xml/TimeTable/\" + this.state.departureSite + \"/\" + this.state.arrivalSite + \"/\" + this.state.flightDate, init).then(function (response) {\n        // console.log(response.data);\n        self.getDepartureDetails(response.data);\n      }).catch(function (error) {\n        console.log(error);\n      });\n    }\n  }, {\n    key: \"getDepartureDetails\",\n    value: function getDepartureDetails(flightData) {\n      var parser = new DOMParser();\n      var xmlDoc = parser.parseFromString(flightData, \"text/xml\");\n\n      if (!xmlDoc.getElementsByTagName(\"Success\").length === 0) {\n        console.log(\"Search Failed!\");\n        this.setState({\n          flightExists: false,\n          departureDetailsLoaded: true\n        });\n      } else {\n        var flightDepartureTime = xmlDoc.getElementsByTagName(\"FlightDetails\")[0].getAttribute(\"FLSDepartureDateTime\");\n        var flightDepartureTimeZone = xmlDoc.getElementsByTagName(\"FlightDetails\")[0].getAttribute(\"FLSDepartureTimeOffset\");\n        this.setState({\n          departureTime: flightDepartureTime,\n          departureTimeZone: flightDepartureTimeZone\n        });\n        this.setState({\n          flightExists: true,\n          departureDetailsLoaded: true\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110\n        },\n        __self: this\n      }, React.createElement(Header, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113\n        },\n        __self: this\n      }, this.state.mapsAPI !== \"\" && React.createElement(\"div\", {\n        className: \"mapPane\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      }, React.createElement(DirectionsMap, {\n        origin: this.state.testOrigin,\n        destination: this.state.testDest,\n        travelMode: this.state.travelMode,\n        drivingOptions: this.state.drivingOptions,\n        googleMapURL: \"https://maps.googleapis.com/maps/api/js?key=\" + this.state.mapsAPI + \"&v=3.exp&libraries=geometry,drawing,places\",\n        mapsAPI: this.state.mapsAPI,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116\n        },\n        __self: this\n      })), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        },\n        __self: this\n      }, this.state.departureSite), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      }, this.state.arrivalSite), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }, this.state.airline), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }, this.state.flightNum), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }, this.state.departureTime), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }, this.state.departureTimeZone)));\n    }\n  }]);\n\n  return ResultPage;\n}(Component);\n\nexport { ResultPage as default };","map":{"version":3,"sources":["C:\\Users\\zhang\\OneDrive\\Documents\\Personal Projects\\departure-planner\\react-backend\\client\\src\\components\\ResultPage.js"],"names":["React","Component","ReactLoading","Header","DirectionsMap","axios","ResultPage","props","state","departureSite","location","arrivalSite","airline","flightNum","flightDate","departureDetailsLoaded","departureTime","departureTimeZone","flightExists","curTime","Date","mapsAPI","curTravelTime","testOrigin","testDest","travelMode","drivingOptions","trafficModel","searchFlight","bind","getDepartureDetails","console","log","apiKey","process","env","REACT_APP_GOOGLE_API_KEY","setState","flightSearchKey","REACT_APP_FLIGHT_API_KEY","proxyurl","init","headers","params","self","get","then","response","data","catch","error","flightData","parser","DOMParser","xmlDoc","parseFromString","getElementsByTagName","length","flightDepartureTime","getAttribute","flightDepartureTimeZone"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,YAAP,MAAyB,eAAzB;AAGA,OAAOC,MAAP,MAAmB,aAAnB;AACA,OAAOC,aAAP,MAA0B,oBAA1B;AAEA,OAAOC,KAAP,MAAkB,OAAlB;;IAIqBC,U;;;;;AACnB,sBAAYC,KAAZ,EAAkB;AAAA;;AAAA;;AAChB,oFAAMA,KAAN;AACA,UAAKC,KAAL,GAAa;AACXC,MAAAA,aAAa,EAAE,MAAKF,KAAL,CAAWG,QAAX,CAAoBF,KAApB,CAA0BC,aAD9B;AAEXE,MAAAA,WAAW,EAAE,MAAKJ,KAAL,CAAWG,QAAX,CAAoBF,KAApB,CAA0BG,WAF5B;AAGXC,MAAAA,OAAO,EAAE,MAAKL,KAAL,CAAWG,QAAX,CAAoBF,KAApB,CAA0BI,OAHxB;AAIXC,MAAAA,SAAS,EAAE,MAAKN,KAAL,CAAWG,QAAX,CAAoBF,KAApB,CAA0BK,SAJ1B;AAKXC,MAAAA,UAAU,EAAE,MAAKP,KAAL,CAAWG,QAAX,CAAoBF,KAApB,CAA0BM,UAL3B;AAOXC,MAAAA,sBAAsB,EAAE,KAPb;AAQXC,MAAAA,aAAa,EAAE,EARJ;AASXC,MAAAA,iBAAiB,EAAE,EATR;AAUXC,MAAAA,YAAY,EAAE,IAVH;AAWXC,MAAAA,OAAO,EAAE,IAAIC,IAAJ,EAXE;AAaXC,MAAAA,OAAO,EAAE,EAbE;AAgBXC,MAAAA,aAAa,EAAE,IAhBJ;AAmBXC,MAAAA,UAAU,EAAE,cAnBD;AAoBXC,MAAAA,QAAQ,EAAE,KApBC;AAqBXC,MAAAA,UAAU,EAAE,SArBD;AAsBXC,MAAAA,cAAc,EAAE;AACdV,QAAAA,aAAa,EAAE,IAAII,IAAJ,EADD;AAEdO,QAAAA,YAAY,EAAE;AAFA;AAtBL,KAAb;AA4BA,UAAKC,YAAL,GAAoB,MAAKA,YAAL,CAAkBC,IAAlB,uDAApB;AACA,UAAKC,mBAAL,GAA2B,MAAKA,mBAAL,CAAyBD,IAAzB,uDAA3B;AA/BgB;AAiCjB;;;;wCAEkB;AACfE,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAKxB,KAAjB;AAEA,UAAMyB,MAAM,GAAGC,OAAO,CAACC,GAAR,CAAYC,wBAA3B;AACA,WAAKC,QAAL,CAAc;AAAChB,QAAAA,OAAO,EAAEY;AAAV,OAAd,EAJe,CAMnB;AACC;;;mCAGa;AACZ,UAAMK,eAAe,GAAGJ,OAAO,CAACC,GAAR,CAAYI,wBAApC;AACA,UAAMC,QAAQ,GAAG,sCAAjB;AAEA,UAAMC,IAAI,GAAG;AACXC,QAAAA,OAAO,EAAE;AACP,uCAA6BJ;AADtB,SADE;AAIXK,QAAAA,MAAM,EAAE;AACN,qBAAW,KAAKnC,KAAL,CAAWI,OADhB;AAEN,0BAAgB,KAAKJ,KAAL,CAAWK;AAFrB;AAJG,OAAb;AAUA,UAAI+B,IAAI,GAAG,IAAX;AAEAvC,MAAAA,KAAK,CAACwC,GAAN,CAAUL,QAAQ,GAAG,sDAAX,GACR,KAAKhC,KAAL,CAAWC,aADH,GACmB,GADnB,GACyB,KAAKD,KAAL,CAAWG,WADpC,GACkD,GADlD,GAER,KAAKH,KAAL,CAAWM,UAFb,EAEyB2B,IAFzB,EAGCK,IAHD,CAGM,UAAUC,QAAV,EAAoB;AACxB;AACAH,QAAAA,IAAI,CAACd,mBAAL,CAAyBiB,QAAQ,CAACC,IAAlC;AACD,OAND,EAOCC,KAPD,CAOO,UAAUC,KAAV,EAAiB;AACtBnB,QAAAA,OAAO,CAACC,GAAR,CAAYkB,KAAZ;AACD,OATD;AAWD;;;wCAEmBC,U,EAAW;AAC7B,UAAIC,MAAM,GAAG,IAAIC,SAAJ,EAAb;AACA,UAAIC,MAAM,GAAGF,MAAM,CAACG,eAAP,CAAuBJ,UAAvB,EAAkC,UAAlC,CAAb;;AAGA,UAAG,CAACG,MAAM,CAACE,oBAAP,CAA4B,SAA5B,EAAuCC,MAAxC,KAAmD,CAAtD,EAAwD;AACtD1B,QAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ;AACA,aAAKK,QAAL,CAAc;AAACnB,UAAAA,YAAY,EAAE,KAAf;AAAsBH,UAAAA,sBAAsB,EAAE;AAA9C,SAAd;AACD,OAHD,MAKI;AACF,YAAI2C,mBAAmB,GAAGJ,MAAM,CAACE,oBAAP,CAA4B,eAA5B,EAA6C,CAA7C,EAAgDG,YAAhD,CAA6D,sBAA7D,CAA1B;AACA,YAAIC,uBAAuB,GAAGN,MAAM,CAACE,oBAAP,CAA4B,eAA5B,EAA6C,CAA7C,EAAgDG,YAAhD,CAA6D,wBAA7D,CAA9B;AAEA,aAAKtB,QAAL,CAAc;AAACrB,UAAAA,aAAa,EAAE0C,mBAAhB;AAAqCzC,UAAAA,iBAAiB,EAAE2C;AAAxD,SAAd;AACA,aAAKvB,QAAL,CAAc;AAACnB,UAAAA,YAAY,EAAE,IAAf;AAAqBH,UAAAA,sBAAsB,EAAE;AAA7C,SAAd;AACD;AACF;;;6BAIO;AACN,aACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,EAGM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACK,KAAKP,KAAL,CAAWa,OAAX,KAAuB,EAAvB,IACD;AAAK,QAAA,SAAS,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,aAAD;AACE,QAAA,MAAM,EAAE,KAAKb,KAAL,CAAWe,UADrB;AAEE,QAAA,WAAW,EAAE,KAAKf,KAAL,CAAWgB,QAF1B;AAGE,QAAA,UAAU,EAAE,KAAKhB,KAAL,CAAWiB,UAHzB;AAIE,QAAA,cAAc,EAAE,KAAKjB,KAAL,CAAWkB,cAJ7B;AAKE,QAAA,YAAY,EAAE,iDAAiD,KAAKlB,KAAL,CAAWa,OAA5D,GAAsE,4CALtF;AAME,QAAA,OAAO,EAAE,KAAKb,KAAL,CAAWa,OANtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CAFJ,EAYE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAI,KAAKb,KAAL,CAAWC,aAAf,CAZF,EAaE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAI,KAAKD,KAAL,CAAWG,WAAf,CAbF,EAcE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAI,KAAKH,KAAL,CAAWI,OAAf,CAdF,EAeE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAI,KAAKJ,KAAL,CAAWK,SAAf,CAfF,EAgBE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAI,KAAKL,KAAL,CAAWQ,aAAf,CAhBF,EAiBE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAI,KAAKR,KAAL,CAAWS,iBAAf,CAjBF,CAHN,CADF;AAyBD;;;;EA1HqChB,S;;SAAnBK,U","sourcesContent":["import React, { Component } from 'react';\r\nimport ReactLoading from 'react-loading';\r\n\r\n\r\nimport Header from './Header.js';\r\nimport DirectionsMap from './DirectionsMap.js'\r\n\r\nimport axios from 'axios'\r\n\r\n\r\n\r\nexport default class ResultPage extends Component {\r\n  constructor(props){\r\n    super(props)\r\n    this.state = {\r\n      departureSite: this.props.location.state.departureSite,\r\n      arrivalSite: this.props.location.state.arrivalSite,\r\n      airline: this.props.location.state.airline,\r\n      flightNum: this.props.location.state.flightNum,\r\n      flightDate: this.props.location.state.flightDate,\r\n\r\n      departureDetailsLoaded: false,\r\n      departureTime: \"\",\r\n      departureTimeZone: \"\",\r\n      flightExists: null,\r\n      curTime: new Date(),\r\n\r\n      mapsAPI: \"\", \r\n\r\n\r\n      curTravelTime: null,\r\n\r\n\r\n      testOrigin: \"Eaton Centre\",\r\n      testDest: \"YYZ\",\r\n      travelMode: \"DRIVING\",\r\n      drivingOptions: {\r\n        departureTime: new Date(),\r\n        trafficModel: 'bestguess'\r\n      },\r\n    }\r\n\r\n    this.searchFlight = this.searchFlight.bind(this);\r\n    this.getDepartureDetails = this.getDepartureDetails.bind(this);\r\n\r\n  }\r\n\r\n  componentDidMount(){\r\n      console.log(this.state);\r\n\r\n      const apiKey = process.env.REACT_APP_GOOGLE_API_KEY;\r\n      this.setState({mapsAPI: apiKey})\r\n\r\n  //  this.searchFlight();\r\n  }\r\n\r\n\r\n  searchFlight(){\r\n    const flightSearchKey = process.env.REACT_APP_FLIGHT_API_KEY;\r\n    const proxyurl = \"https://cors-anywhere.herokuapp.com/\";\r\n    \r\n    const init = {\r\n      headers: {\r\n        \"Ocp-Apim-Subscription-Key\": flightSearchKey\r\n      },\r\n      params: {\r\n        \"Airline\": this.state.airline,\r\n        \"FlightNumber\": this.state.flightNum,\r\n      }\r\n    }\r\n\r\n    var self = this;\r\n\r\n    axios.get(proxyurl + \"https://flightlookup.azure-api.net/v1/xml/TimeTable/\" \r\n    + this.state.departureSite + \"/\" + this.state.arrivalSite + \"/\" \r\n    + this.state.flightDate, init)\r\n    .then(function (response) {\r\n      // console.log(response.data);\r\n      self.getDepartureDetails(response.data);      \r\n    })\r\n    .catch(function (error) {\r\n      console.log(error);\r\n    });\r\n\r\n  }\r\n\r\n  getDepartureDetails(flightData){\r\n    var parser = new DOMParser();\r\n    var xmlDoc = parser.parseFromString(flightData,\"text/xml\");\r\n    \r\n   \r\n    if(!xmlDoc.getElementsByTagName(\"Success\").length === 0){\r\n      console.log(\"Search Failed!\");\r\n      this.setState({flightExists: false, departureDetailsLoaded: true});\r\n    }\r\n\r\n    else{\r\n      var flightDepartureTime = xmlDoc.getElementsByTagName(\"FlightDetails\")[0].getAttribute(\"FLSDepartureDateTime\");\r\n      var flightDepartureTimeZone = xmlDoc.getElementsByTagName(\"FlightDetails\")[0].getAttribute(\"FLSDepartureTimeOffset\");\r\n\r\n      this.setState({departureTime: flightDepartureTime, departureTimeZone: flightDepartureTimeZone});\r\n      this.setState({flightExists: true, departureDetailsLoaded: true});\r\n    }\r\n  }\r\n\r\n\r\n\r\n  render(){\r\n    return(\r\n      <div>\r\n          <Header>\r\n          </Header>\r\n            <div>\r\n                {this.state.mapsAPI !== \"\" && \r\n                <div className=\"mapPane\">        \r\n                  <DirectionsMap\r\n                    origin={this.state.testOrigin} \r\n                    destination={this.state.testDest} \r\n                    travelMode={this.state.travelMode} \r\n                    drivingOptions={this.state.drivingOptions}\r\n                    googleMapURL={\"https://maps.googleapis.com/maps/api/js?key=\" + this.state.mapsAPI + \"&v=3.exp&libraries=geometry,drawing,places\"}\r\n                    mapsAPI={this.state.mapsAPI}/> \r\n                </div>\r\n                }\r\n              <p>{this.state.departureSite}</p>\r\n              <p>{this.state.arrivalSite}</p>\r\n              <p>{this.state.airline}</p>\r\n              <p>{this.state.flightNum}</p>\r\n              <p>{this.state.departureTime}</p>\r\n              <p>{this.state.departureTimeZone}</p>\r\n            </div>\r\n    </div>\r\n    );\r\n  }\r\n}"]},"metadata":{},"sourceType":"module"}